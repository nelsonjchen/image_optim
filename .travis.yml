language:
  - ruby
rvm:
  - 1.8.7
  - 1.9.2
  - 1.9.3
  - 2.0.0
  - jruby-18mode
  - jruby-19mode
  - ree
script: bundle exec rspec
before_install:
  - gem update bundler
  - bundle --version
  - gem update --system 2.1.11
  - gem --version
  - sudo apt-get update -qq
  - sudo apt-get install -qq advancecomp gifsicle jhead jpegoptim libjpeg-progs optipng pngcrush
  - wget http://static.jonof.id.au/dl/kenutils/pngout-20130221-linux.tar.gz
  - tar -xzf pngout-*-linux.tar.gz
  - mv pngout-*-linux pngout-linux
  - git clone https://code.google.com/p/zopfli/
   # `bundle install` doesn't like nested git repositories in 1.8 versions.
  - rm -rf zopfli/.git
  - make -C zopfli/ zopflipng
  - mkdir zopflipng-linux && mv zopfli/zopflipng zopflipng-linux
  - rm -rf zopfli/
  - pwd
env:
  - PATH=pngout-linux/x86_64:zopflipng-linux/:$PATH
